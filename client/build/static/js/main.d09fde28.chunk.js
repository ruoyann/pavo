(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{172:function(e,t,r){},177:function(e,t,r){"use strict";r.r(t);var o=r(0),n=r.n(o),s=r(10),a=r.n(s),i=(r(91),r(17)),c=r(64),u=r(221),d=r(206),l=r(208),h=r(11),m=r(107),j=Object(m.io)({autoConnect:!1});j.onAny((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];console.log("Catch-all listener",e,r)}));var p=j,b=r(2),f=Object(d.a)((function(e){return{button:{background:"#74b816",color:"white",width:"100%",fontSize:20,margin:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"84%"}}})),g=function(e){var t=e.username,r=e.setInvalidUsername,n=f(),s=Object(h.f)(),a=Object(o.useState)(""),c=Object(i.a)(a,2),d=c[0],m=c[1],j=Object(o.useState)(!1),g=Object(i.a)(j,2),O=g[0],x=g[1],v=Object(o.useState)(!1),C=Object(i.a)(v,2),y=C[0],w=C[1];Object(o.useEffect)((function(){p.connect()}),[]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.a,{variant:"contained",className:n.button,onClick:function(e){e.preventDefault(),""===t?r(!0):(r(!1),x(!O))},children:"Join a session"}),O?Object(b.jsxs)("div",{style:{marginBottom:10,width:"100%"},children:[Object(b.jsx)(u.a,{label:"Classroom code",id:"margin-normal",name:"name",className:n.textField,onChange:function(e){m(e.target.value)},style:{width:"60%"},helperText:y?"Please enter a valid classroom code":"",error:y}),Object(b.jsx)(l.a,{type:"submit",variant:"contained",color:"default",onClick:function(e){e.preventDefault(),""===d?w(!0):(w(!1),p.emit("userLogin",{roomCode:d.toLowerCase().trim(),username:t},(function(e){var t=e.error,r=e.user;t?alert(t):s.push("/room/".concat(d),{isHost:!1,user:r})})))},style:{marginTop:"10px",marginLeft:"50px",width:"20%",backgroundColor:"#d6336c",color:"white"},children:"Enter"})]}):null]})},O=Object(d.a)((function(e){return{button:{background:"#f76705",color:"white",width:"100%",fontSize:20,margin:e.spacing(1)}}})),x=function(e){var t=e.username,r=e.setInvalidUsername,n=O(),s=Object(h.f)();Object(o.useEffect)((function(){p.connect(),p.once("create",(function(e){var t=e.roomCode,r=e.host;s.push("/room/".concat(t),{isHost:!0,user:r})}))}),[t]);var a=function(){p.emit("create",{username:t})};return Object(b.jsx)(l.a,{variant:"contained",className:n.button,onClick:function(){""===t?r(!0):(r(!1),a())},children:"Create a new session"})},v=Object(d.a)((function(e){return{textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:e.spacing(2),width:"100%"}}})),C=function(e){var t=e.setUsername,r=e.invalidUsername,n=v();return Object(o.useEffect)((function(){p.connect()}),[]),Object(b.jsx)(u.a,{label:"Username",id:"margin-normal",name:"name",className:n.textField,onChange:function(e){t(e.target.value)},helperText:r?"Please enter a username":"",error:r})},y=r(213),w=function(){return Object(b.jsxs)("div",{className:"fixed-bottom",style:{paddingTop:"70px"},children:[Object(b.jsx)(y.a,{variant:"body1",align:"center",gutterBottom:!0,children:"A whiteboard for a fun and interactive classroom experience"}),Object(b.jsx)(y.a,{variant:"body2",align:"center",children:"\ud83e\udd9a Made for Lifehack 2021 \ud83e\udd9a"})]})},I=r(222),S=r(214),D=r(180),k=r.p+"static/media/pavo_logo.aaa927f9.svg",U=r(112),E=r.p+"static/media/peacockSound.72d272aa.m4a",F=Object(d.a)((function(e){return{paper:Object(c.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},e.breakpoints.up(600+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)})}})),R=function(){var e=Object(o.useState)(""),t=Object(i.a)(e,2),r=t[0],n=t[1],s=Object(o.useState)(!1),a=Object(i.a)(s,2),c=a[0],u=a[1],d=Object(U.a)(E),l=Object(i.a)(d,1)[0],h=F();return Object(b.jsxs)(I.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column",children:[Object(b.jsx)(S.a,{in:!0,children:Object(b.jsxs)(D.a,{elevation:2,className:h.paper,children:[Object(b.jsx)("img",{src:k,alt:"Peacock!",onClick:function(e){return function(e){5===e.detail&&l()}(e)},style:{width:"400px",height:"300px"}}),Object(b.jsx)(C,{setUsername:n,invalidUsername:c}),Object(b.jsx)(g,{username:r,setInvalidUsername:u}),Object(b.jsx)(x,{username:r,setInvalidUsername:u})]})}),Object(b.jsx)(w,{})]})},N=r(215),z=r(114),H=r.n(z),L=(r(172),r(223)),B=Object(d.a)((function(e){return{button:{background:"#d6336c",color:"white",height:70,width:400,fontSize:30,margin:e.spacing(3)}}})),T=function(e){var t=e.isHost,r=e.roomHost,o=e.roomCode,n=(e.users,e.content),s=e.currentUser,a=B();return Object(b.jsxs)("div",{className:"waitingRoom",children:[Object(b.jsxs)(y.a,{variant:"h2",style:{margin:10},children:["You are in room ",o]}),Object(b.jsxs)("div",{className:"waitingRoom__content",children:[Object(b.jsxs)(D.a,{className:"leader waitingRoom__paper",elevation:3,children:[Object(b.jsx)(y.a,{variant:"h3",style:{margin:10},children:"Session Leader"}),Object(b.jsx)("img",{src:k,alt:"logo",style:{width:"50%",minWidth:"50%"}}),Object(b.jsxs)(y.a,{variant:"h3",children:[" ",r.username," "]})]}),Object(b.jsxs)(D.a,{className:"users waitingRoom__paper",elevation:3,children:[Object(b.jsx)(y.a,{variant:"h6",align:"center",children:"Users"}),Object(b.jsx)(y.a,{variant:"body1",align:"center",style:{width:"60%"},children:Object(b.jsx)("ol",{children:n.length>0&&n.map(function(e){return function(t){return Object(b.jsxs)("li",{children:[r.username===t.username?r.username+" [Host]":t.username,e&&t.userID!==s.userID&&Object(b.jsx)(L.a,{title:"Kick user from room",children:Object(b.jsx)(N.a,{edge:"end",onClick:function(){return function(e){p.emit("remove-user",{user:e,roomCode:o})}(t)},children:Object(b.jsx)(H.a,{})})})]})}}(t))})})]})]}),t&&Object(b.jsx)(l.a,{type:"submit",variant:"contained",color:"default",size:"large",className:a.button,onClick:function(){p.emit("startSession",o)},children:"Start session"}),!t&&Object(b.jsx)(y.a,{variant:"h6",className:"loading",children:"Waiting for host to start meeting"}),Object(b.jsx)(w,{})]})},W=r(116),_=r(57),M=r(70),P=r(71),q=r(73),J=r(72),V=r(56),A=r(216),G=function(e){Object(q.a)(r,e);var t=Object(J.a)(r);function r(e){var o;return Object(M.a)(this,r),(o=t.call(this,e)).isDrawing=!1,o.clearWhiteboard=function(){var e=document.getElementById("board-".concat(o.props.roomCode,"-").concat(o.props.user.userID));e&&(e.getContext("2d").clearRect(0,0,e.width,e.height),p.emit("clear",{roomCode:o.props.roomCode,user:o.props.user}))},o.state={shared:!1},p.on("canvas-data",(function(t){if(0===t.roomCode.localeCompare(e.roomCode)&&0===t.user.userID.localeCompare(e.user.userID))var r=this,o=setInterval((function(){if(!r.isDrawing){r.isDrawing=!0,clearInterval(o);var n=new Image,s=document.querySelector("#board-".concat(e.roomCode,"-").concat(e.user.userID));if(s){var a=s.getContext("2d");n.onload=function(){a.drawImage(n,0,0),r.isDrawing=!1},n.src=t.image}}}),200)})),p.on("clear",(function(t){if(t.roomCode===e.roomCode&&t.user.userID===e.user.userID){var r=document.getElementById("board-".concat(o.props.roomCode,"-").concat(o.props.user.userID));if(!r)return;r.getContext("2d").clearRect(0,0,r.width,r.height)}})),p.on("get-whiteboards",(function(t){if(t.roomCode===e.roomCode&&t.user.userID!==e.user.userID&&e.currentUser.userID!==t.user.userID){var r=document.querySelector("#board-".concat(o.props.roomCode,"-").concat(o.props.user.userID));if(!r)return;var n=r.toDataURL("image/png");p.emit("canvas-data",{image:n,roomCode:o.props.roomCode,user:o.props.user})}})),o.handleShare=o.handleShare.bind(Object(V.a)(o)),o.stopShare=o.stopShare.bind(Object(V.a)(o)),o}return Object(P.a)(r,[{key:"componentDidMount",value:function(){this.drawOnCanvas(),this.initialiseImage()}},{key:"componentWillReceiveProps",value:function(e){this.ctx.strokeStyle=e.eraseMode?"#FFFFFF":e.color,this.ctx.lineWidth=e.size}},{key:"drawOnCanvas",value:function(){var e=document.querySelector("#board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(e){this.ctx=e.getContext("2d");var t=this.ctx,r=document.querySelector("#sketch-".concat(this.props.roomCode,"-").concat(this.props.user.userID)),o=getComputedStyle(r);e.width=parseInt(o.getPropertyValue("width")),e.height=parseInt(o.getPropertyValue("height"));var n={x:0,y:0},s={x:0,y:0};e.addEventListener("mousemove",(function(e){s.x=n.x,s.y=n.y,n.x=e.pageX-this.offsetLeft,n.y=e.pageY-this.offsetTop}),!1),t.lineWidth=this.props.size,t.lineJoin="round",t.lineCap="round",t.strokeStyle=this.props.eraseMode?"#FFFFFF":this.props.color,e.addEventListener("mousedown",(function(t){e.addEventListener("mousemove",i,!1)}),!1),e.addEventListener("mouseup",(function(){e.removeEventListener("mousemove",i,!1)}),!1);var a=this,i=function(){t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(n.x,n.y),t.closePath(),t.stroke(),void 0!=a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout((function(){var t=e.toDataURL("image/png");p.emit("canvas-data",{image:t,roomCode:a.props.roomCode,user:a.props.user})}),1e3)}}}},{key:"handleShare",value:function(){var e=document.querySelector("#board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(e){var t=e.toDataURL("image/png");p.emit("share-whiteboard",{image:t,roomCode:this.props.roomCode,user:this.props.user}),this.setState({shared:!0})}}},{key:"stopShare",value:function(){p.emit("stop-share",{roomCode:this.props.roomCode,user:this.props.user}),this.setState({shared:!1})}},{key:"initialiseImage",value:function(){if(this.props.image){var e=new Image,t=document.getElementById("board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(!t)return null;var r=t.getContext("2d");e.onload=function(){r.drawImage(e,0,0)},e.src=this.props.image}var o=document.getElementById("board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));(r=o.getContext("2d")).fillStyle="white",r.fillRect(0,0,o.width,o.height)}},{key:"render",value:function(){return console.log("props are in render",this.props),Object(b.jsxs)(A.a,{item:!0,xs:12,children:[Object(b.jsx)(y.a,{variant:"h5",children:this.props.user?this.props.user.username:""}),this.state.shared?Object(b.jsx)(l.a,{onClick:this.stopShare,children:"Stop sharing whiteboard"}):Object(b.jsx)(l.a,{onClick:this.handleShare,children:"Share whiteboard"}),Object(b.jsx)(l.a,{onClick:this.clearWhiteboard.bind(this),children:"Clear whiteboard"}),Object(b.jsx)("div",{class:"sketch",id:"sketch-".concat(this.props.roomCode,"-").concat(this.props.user.userID),children:Object(b.jsx)("canvas",{className:"board",id:"board-".concat(this.props.roomCode,"-").concat(this.props.user.userID),style:{border:"1px solid #000000"},width:"800",height:"800"})})]})}}]),r}(n.a.Component),Y=r(212),K=r(217),Q=function(e){return function(t){return Object(b.jsx)(A.a,{container:!0,spacing:2,justifyContent:"flex-start",children:Object(b.jsx)(G,{color:e.state.color,size:e.state.size,roomCode:e.props.roomCode,user:t.user,image:t.image,eraseMode:e.state.erase,currentUser:e.props.currentUser})})}},X=function(e){Object(q.a)(r,e);var t=Object(J.a)(r);function r(e){var o;return Object(M.a)(this,r),(o=t.call(this,e)).changeEraseMode=function(){o.setState(Object(_.a)(Object(_.a)({},o.state),{},{erase:!o.state.erase}))},o.state={color:"#000000",size:"5",erase:!1},o}return Object(P.a)(r,[{key:"changeColor",value:function(e){this.setState({color:e.target.value})}},{key:"changeSize",value:function(e){this.setState({size:e.target.value})}},{key:"render",value:function(){var e=this;return console.log("current user",this.props.currentUser),Object(b.jsxs)(A.a,{container:!0,spacing:2,alignItems:"center",children:[Object(b.jsx)(A.a,{item:!0,xs:1,children:Object(b.jsx)("div",{style:{border:"1px solid #000000",justifyContent:"center"},children:Object(b.jsxs)(Y.a,{children:[Object(b.jsx)(K.a,{children:Object(b.jsxs)("div",{className:"color-picker-container",children:[Object(b.jsx)(y.a,{variant:"body1",children:"Brush Color : \xa0"}),Object(b.jsx)("input",{type:"color",value:this.state.color,onChange:this.changeColor.bind(this)})]})}),Object(b.jsx)(K.a,{children:Object(b.jsxs)("div",{className:"brushsize-container",children:[Object(b.jsx)(y.a,{variant:"body1",children:"Brush Size : \xa0"}),Object(b.jsxs)("select",{value:this.state.size,onChange:this.changeSize.bind(this),children:[Object(b.jsx)("option",{children:" 5 "}),Object(b.jsx)("option",{children:" 10 "}),Object(b.jsx)("option",{children:" 15 "}),Object(b.jsx)("option",{children:" 20 "}),Object(b.jsx)("option",{children:" 25 "}),Object(b.jsx)("option",{children:" 30 "})]})]})}),Object(b.jsx)(K.a,{children:Object(b.jsx)(l.a,{onClick:this.changeEraseMode.bind(this),children:this.state.erase?"Stop erasing":"Erase"})}),Object(b.jsx)(K.a,{children:this.props.isHost&&Object(b.jsx)(l.a,{onClick:function(){e.state.focus&&p.emit("get-whiteboards",{roomCode:e.props.roomCode,user:e.props.currentUser}),e.setState(Object(_.a)(Object(_.a)({},e.state),{},{focus:!e.state.focus}))},children:this.state.focus?"View all":"View yours"})})]})})}),Object(b.jsxs)(A.a,{item:!0,xs:10,children:[!this.props.isHost&&this.props.shareWhiteboards.map(Q(this)),Q(this)({user:this.props.currentUser}),this.props.isHost&&!this.state.focus&&this.props.content.map(Q(this))]})]})}}]),r}(n.a.Component),Z=r(218),$=r(219),ee=Object(d.a)((function(e){return{icon:{color:"#ff5138",marginRight:e.spacing(2)},root:{flexGrow:1,marginBottom:e.spacing(1)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),te=function(){var e=Object(h.f)(),t=ee();return Object(b.jsx)("div",{className:t.root,children:Object(b.jsx)(Z.a,{position:"relative",style:{backgroundColor:"#f3f5f8"},elevation:1,children:Object(b.jsx)($.a,{children:Object(b.jsx)("img",{src:k,style:{maxWidth:50},className:"img",onClick:function(){window.confirm("Do you want to go home?")&&e.push("/")}})})})})},re=function(e){var t=e.isHost,r=e.roomCode,n=e.content,s=e.currentUser,a=Object(o.useState)([]),c=Object(i.a)(a,2),u=c[0],d=c[1];p.on("share-whiteboard",(function(e){-1===u.findIndex((function(t){return t.roomCode===e.roomCode&&t.user.userID===e.user.userID}))&&e.roomCode===r&&e.user.userID!==s.userID&&d([].concat(Object(W.a)(u),[e]))})),p.on("stop-share",(function(e){if(-1!==u.findIndex((function(t){return t.roomCode===e.roomCode&&t.user.userID===e.user.userID}))&&e.userID!==s.username){var t=u.filter((function(t){return t.roomCode!==e.roomCode||t.username!==e.username}));d(t)}}));var l=n.filter((function(e){return e.userID!==s.userID})).map((function(e){return{user:{userID:e.userID,username:e.username}}}));return Object(b.jsxs)(A.a,{container:!0,spacing:2,children:[Object(b.jsx)(A.a,{item:!0,xs:12,children:Object(b.jsx)(te,{})}),Object(b.jsx)(A.a,{item:!0,xs:1}),Object(b.jsx)(A.a,{item:!0,xs:11,children:Object(b.jsxs)(y.a,{variant:"h3",children:["Room ",r]})}),Object(b.jsx)(A.a,{item:!0,xs:12,children:Object(b.jsx)(X,{isHost:t,roomCode:r,currentUser:s,shareWhiteboards:u,content:l})})]})},oe=function(){var e=window.location.href.split("/").slice(-1)[0],t=Object(o.useState)(1),r=Object(i.a)(t,2),n=r[0],s=r[1],a=Object(o.useState)({users:[]}),c=Object(i.a)(a,2),u=c[0],d=c[1],l=Object(o.useState)(!1),m=Object(i.a)(l,2),j=m[0],f=m[1],g=Object(o.useState)({}),O=Object(i.a)(g,2),x=O[0],v=O[1],C=Object(h.g)(),y=C.state.isHost,w=C.state.user,I=Object(h.f)();return window.onbeforeunload=function(){p.emit("leave",w)},Object(o.useEffect)((function(){p.connect(),p.emit("userJoinedRoom",{roomCode:e,user:w},(function(e){var t=e.started;f(t)})),p.on("update_user",(function(e){console.log(e),s(e.users.length),d(e.users),v(e.roomHost),0!==w.username.length&&-1===e.users.findIndex((function(e){return e.userID===w.userID}))&&(I.push("/"),alert("Sorry, you have been removed by the host"))})),p.on("update_session_start",(function(e){f(e.start)}))}),[]),console.log("content in room page",u),j?Object(b.jsx)(re,{isHost:y,roomCode:e,content:u,currentUser:w}):Object(b.jsx)(T,{isHost:y,roomHost:x,roomCode:e,users:n,content:u,currentUser:w})},ne=r(61),se=r(115),ae=r(220),ie=Object(se.a)({typography:{fontFamily:"Quicksand",fontWeightRegular:500,body1:{fontSize:"1.1rem"}}});var ce=function(){return Object(b.jsx)(ae.a,{theme:ie,children:Object(b.jsx)(ne.a,{children:Object(b.jsxs)(h.c,{children:[Object(b.jsx)(h.a,{exact:!0,path:"/",component:R}),Object(b.jsx)(h.a,{path:"/room/:roomCode",component:oe})]})})})};a.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(ce,{})}),document.getElementById("root"))},91:function(e,t,r){}},[[177,1,2]]]);
//# sourceMappingURL=main.d09fde28.chunk.js.map