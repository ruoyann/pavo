(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{154:function(e,t,r){},159:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),s=r(9),a=r.n(s),i=(r(80),r(16)),c=r(203),u=r(191),d=r(194),l=r(11),h=r(96),m=Object(h.io)({autoConnect:!1});m.onAny((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console.log("Catch-all listener",e,r)}));var j=m,p=r(2),b=Object(u.a)((function(e){return{button:{background:"#74b816",color:"white",width:"100%",fontSize:20,margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20},root:{padding:e.spacing(3,2)},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"84%"}}})),f=function(e){var t=e.username,r=e.setInvalidUsername,o=b(),s=Object(l.f)(),a=Object(n.useState)(""),u=Object(i.a)(a,2),h=u[0],m=u[1],f=Object(n.useState)(!1),g=Object(i.a)(f,2),x=g[0],O=g[1],v=Object(n.useState)(!1),C=Object(i.a)(v,2),y=C[0],I=C[1];Object(n.useEffect)((function(){j.connect()}),[]);return Object(p.jsxs)("div",{children:[Object(p.jsx)(d.a,{variant:"contained",className:o.button,onClick:function(e){e.preventDefault(),""===t?r(!0):(r(!1),O(!x))},children:"Join a session"}),x?Object(p.jsxs)("div",{style:{marginBottom:10},children:[Object(p.jsx)(c.a,{label:"Classroom code",id:"margin-normal",name:"name",className:o.textField,onChange:function(e){m(e.target.value)},style:{width:"60%"},helperText:y?"Please enter a valid classroom code":"",error:y}),Object(p.jsx)(d.a,{type:"submit",variant:"contained",color:"default",onClick:function(e){e.preventDefault(),""===h?I(!0):(I(!1),j.emit("userLogin",{roomCode:h.toLowerCase().trim(),username:t},(function(e){var t=e.error,r=e.user;t?alert(t):s.push("/room/".concat(h),{host:!1,user:r})})))},style:{marginTop:"10px",marginLeft:"50px",width:"20%",backgroundColor:"#d6336c",color:"white"},children:"Enter"})]}):null]})},g=Object(u.a)((function(e){return{button:{background:"#f76705",color:"white",width:"100%",fontSize:20,margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20},root:{padding:e.spacing(3,2)},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:320}}})),x=function(e){var t=e.username,r=e.setInvalidUsername,o=g(),s=Object(l.f)();Object(n.useEffect)((function(){j.connect(),j.once("create",(function(e){var t=e.roomCode,r=e.host;s.push("/room/".concat(t),{host:!0,user:r})}))}),[t]);var a=function(){j.emit("create",{username:t})};return Object(p.jsx)(d.a,{variant:"contained",className:o.button,onClick:function(){""===t?r(!0):(r(!1),a())},children:"Create a new session"})},O=Object(u.a)((function(e){return{button:{margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20},root:{padding:e.spacing(3,2)},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"}}})),v=function(e){var t=e.setUsername,r=e.invalidUsername,o=O();return Object(n.useEffect)((function(){j.connect()}),[]),Object(p.jsx)("div",{children:Object(p.jsx)(c.a,{label:"Username",id:"margin-normal",name:"name",className:o.textField,onChange:function(e){t(e.target.value)},helperText:r?"Please enter a username":"",error:r})})},C=r(197),y=function(){return Object(p.jsxs)("div",{className:"fixed-bottom",style:{paddingTop:"70px"},children:[Object(p.jsx)(C.a,{variant:"body1",align:"center",gutterBottom:!0,children:"A whiteboard for a fun and interactive classroom experience"}),Object(p.jsx)(C.a,{variant:"body2",align:"center",children:"Made for Lifehack 2021"})]})},I=r.p+"static/media/pavo_logo.aaa927f9.svg",w=r(101),S=r.p+"static/media/peacockSound.72d272aa.m4a",D=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),r=t[0],o=t[1],s=Object(n.useState)(!1),a=Object(i.a)(s,2),c=a[0],u=a[1],d=Object(w.a)(S),l=Object(i.a)(d,1)[0];return Object(p.jsxs)("div",{children:[Object(p.jsx)("img",{src:I,alt:"Peacock!",onClick:function(e){return function(e){5===e.detail&&l()}(e)},style:{width:"400px",height:"300px"}}),Object(p.jsx)(v,{setUsername:o,invalidUsername:c}),Object(p.jsx)(f,{username:r,setInvalidUsername:u}),Object(p.jsx)(x,{username:r,setInvalidUsername:u}),Object(p.jsx)(y,{})]})},k=r(198),U=r(102),L=r.n(U),z=(r(154),Object(u.a)((function(e){return{button:{background:"#d6336c",color:"white",height:70,width:400,fontSize:30,margin:e.spacing(3)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20},root:{padding:e.spacing(3,2)},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:320}}}))),R=function(e){var t=e.host,r=e.roomCode,n=e.users,o=e.content,s=e.currentUser,a=z();return Object(p.jsxs)("div",{className:"container",children:[Object(p.jsxs)(C.a,{variant:"h2",style:{margin:10},children:["You are in room ",r]}),Object(p.jsxs)("div",{className:"leader",children:[Object(p.jsx)(C.a,{variant:"h3",style:{margin:10},children:"Session Leader"}),Object(p.jsx)("img",{src:I,alt:"logo",style:{width:"50%",minWidth:"50%"}}),Object(p.jsx)(C.a,{variant:"h3",children:" Name "})]}),Object(p.jsx)("div",{className:"users",children:Object(p.jsxs)(C.a,{variant:"h6",children:["Users in room: ",n," ",Object(p.jsx)("br",{}),"List of users:",Object(p.jsx)("ol",{children:o.length>0&&o.map(function(e){return function(t){return Object(p.jsxs)("li",{children:[t.username,e&&t.userID!==s.userID&&Object(p.jsx)(k.a,{edge:"end",onClick:function(){return function(e){j.emit("remove-user",{user:e,roomCode:r})}(t)},children:Object(p.jsx)(L.a,{})})]})}}(t))})]})}),t&&Object(p.jsx)(d.a,{type:"submit",variant:"contained",color:"default",size:"large",className:a.button,onClick:function(){j.emit("startSession",r)},children:"Start session"}),!t&&Object(p.jsx)(C.a,{variant:"h6",children:"Please wait for host to start meeting"}),Object(p.jsx)(y,{})]})},E=r(103),F=r(47),N=r(60),W=r(61),B=r(63),P=r(62),T=r(46),M=r(199),q=function(e){Object(B.a)(r,e);var t=Object(P.a)(r);function r(e){var n;return Object(N.a)(this,r),(n=t.call(this,e)).isDrawing=!1,n.clearWhiteboard=function(){var e=document.getElementById("board-".concat(n.props.roomCode,"-").concat(n.props.user.userID));e&&(e.getContext("2d").clearRect(0,0,e.width,e.height),j.emit("clear",{roomCode:n.props.roomCode,user:n.props.user}))},n.state={shared:!1},j.on("canvas-data",(function(t){if(0===t.roomCode.localeCompare(e.roomCode)&&0===t.user.userID.localeCompare(e.user.userID))var r=this,n=setInterval((function(){if(!r.isDrawing){r.isDrawing=!0,clearInterval(n);var o=new Image,s=document.querySelector("#board-".concat(e.roomCode,"-").concat(e.user.userID));if(s){var a=s.getContext("2d");o.onload=function(){a.drawImage(o,0,0),r.isDrawing=!1},o.src=t.image}}}),200)})),j.on("clear",(function(t){if(t.roomCode===e.roomCode&&t.user.userID===e.user.userID){var r=document.getElementById("board-".concat(n.props.roomCode,"-").concat(n.props.user.userID));if(!r)return;r.getContext("2d").clearRect(0,0,r.width,r.height)}})),j.on("get-whiteboards",(function(t){if(t.roomCode===e.roomCode&&t.user.userID!==e.user.userID&&e.currentUser.userID!==t.user.userID){var r=document.querySelector("#board-".concat(n.props.roomCode,"-").concat(n.props.user.userID));if(!r)return;var o=r.toDataURL("image/png");j.emit("canvas-data",{image:o,roomCode:n.props.roomCode,user:n.props.user})}})),n.handleShare=n.handleShare.bind(Object(T.a)(n)),n.stopShare=n.stopShare.bind(Object(T.a)(n)),n}return Object(W.a)(r,[{key:"componentDidMount",value:function(){this.drawOnCanvas(),this.initialiseImage()}},{key:"componentWillReceiveProps",value:function(e){this.ctx.strokeStyle=e.eraseMode?"#FFFFFF":e.color,this.ctx.lineWidth=e.size}},{key:"drawOnCanvas",value:function(){var e=document.querySelector("#board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(e){this.ctx=e.getContext("2d");var t=this.ctx,r=document.querySelector("#sketch-".concat(this.props.roomCode,"-").concat(this.props.user.userID)),n=getComputedStyle(r);e.width=parseInt(n.getPropertyValue("width")),e.height=parseInt(n.getPropertyValue("height"));var o={x:0,y:0},s={x:0,y:0};e.addEventListener("mousemove",(function(e){s.x=o.x,s.y=o.y,o.x=e.pageX-this.offsetLeft,o.y=e.pageY-this.offsetTop}),!1),t.lineWidth=this.props.size,t.lineJoin="round",t.lineCap="round",t.strokeStyle=this.props.eraseMode?"#FFFFFF":this.props.color,e.addEventListener("mousedown",(function(t){e.addEventListener("mousemove",i,!1)}),!1),e.addEventListener("mouseup",(function(){e.removeEventListener("mousemove",i,!1)}),!1);var a=this,i=function(){t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(o.x,o.y),t.closePath(),t.stroke(),void 0!=a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout((function(){var t=e.toDataURL("image/png");j.emit("canvas-data",{image:t,roomCode:a.props.roomCode,user:a.props.user})}),1e3)}}}},{key:"handleShare",value:function(){var e=document.querySelector("#board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(e){var t=e.toDataURL("image/png");j.emit("share-whiteboard",{image:t,roomCode:this.props.roomCode,user:this.props.user}),this.setState({shared:!0})}}},{key:"stopShare",value:function(){j.emit("stop-share",{roomCode:this.props.roomCode,user:this.props.user}),this.setState({shared:!1})}},{key:"initialiseImage",value:function(){if(this.props.image){var e=new Image,t=document.getElementById("board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));if(!t)return null;var r=t.getContext("2d");e.onload=function(){r.drawImage(e,0,0)},e.src=this.props.image}var n=document.getElementById("board-".concat(this.props.roomCode,"-").concat(this.props.user.userID));(r=n.getContext("2d")).fillStyle="white",r.fillRect(0,0,n.width,n.height)}},{key:"render",value:function(){return console.log("props are in render",this.props),Object(p.jsxs)(M.a,{item:!0,xs:12,children:[Object(p.jsx)(C.a,{variant:"h5",children:this.props.user?this.props.user.username:""}),this.state.shared?Object(p.jsx)(d.a,{onClick:this.stopShare,children:"Stop sharing whiteboard"}):Object(p.jsx)(d.a,{onClick:this.handleShare,children:"Share whiteboard"}),Object(p.jsx)(d.a,{onClick:this.clearWhiteboard.bind(this),children:"Clear whiteboard"}),Object(p.jsx)("div",{class:"sketch",id:"sketch-".concat(this.props.roomCode,"-").concat(this.props.user.userID),children:Object(p.jsx)("canvas",{className:"board",id:"board-".concat(this.props.roomCode,"-").concat(this.props.user.userID),style:{border:"1px solid #000000"},width:"800",height:"800"})})]})}}]),r}(o.a.Component),J=r(196),A=r(200),V=function(e){return function(t){return Object(p.jsx)(M.a,{container:!0,spacing:2,justifyContent:"flex-start",children:Object(p.jsx)(q,{color:e.state.color,size:e.state.size,roomCode:e.props.roomCode,user:t.user,image:t.image,eraseMode:e.state.erase,currentUser:e.props.currentUser})})}},_=function(e){Object(B.a)(r,e);var t=Object(P.a)(r);function r(e){var n;return Object(N.a)(this,r),(n=t.call(this,e)).changeEraseMode=function(){n.setState(Object(F.a)(Object(F.a)({},n.state),{},{erase:!n.state.erase}))},n.state={color:"#000000",size:"5",erase:!1},n}return Object(W.a)(r,[{key:"changeColor",value:function(e){this.setState({color:e.target.value})}},{key:"changeSize",value:function(e){this.setState({size:e.target.value})}},{key:"render",value:function(){var e=this;return console.log("current user",this.props.currentUser),Object(p.jsxs)(M.a,{container:!0,spacing:2,alignItems:"center",children:[Object(p.jsx)(M.a,{item:!0,xs:1,children:Object(p.jsx)("div",{style:{border:"1px solid #000000",justifyContent:"center"},children:Object(p.jsxs)(J.a,{children:[Object(p.jsx)(A.a,{children:Object(p.jsxs)("div",{className:"color-picker-container",children:[Object(p.jsx)(C.a,{variant:"body1",children:"Brush Color : \xa0"}),Object(p.jsx)("input",{type:"color",value:this.state.color,onChange:this.changeColor.bind(this)})]})}),Object(p.jsx)(A.a,{children:Object(p.jsxs)("div",{className:"brushsize-container",children:[Object(p.jsx)(C.a,{variant:"body1",children:"Brush Size : \xa0"}),Object(p.jsxs)("select",{value:this.state.size,onChange:this.changeSize.bind(this),children:[Object(p.jsx)("option",{children:" 5 "}),Object(p.jsx)("option",{children:" 10 "}),Object(p.jsx)("option",{children:" 15 "}),Object(p.jsx)("option",{children:" 20 "}),Object(p.jsx)("option",{children:" 25 "}),Object(p.jsx)("option",{children:" 30 "})]})]})}),Object(p.jsx)(A.a,{children:Object(p.jsx)(d.a,{onClick:this.changeEraseMode.bind(this),children:this.state.erase?"Stop erasing":"Erase"})}),Object(p.jsx)(A.a,{children:this.props.host&&Object(p.jsx)(d.a,{onClick:function(){e.state.focus&&j.emit("get-whiteboards",{roomCode:e.props.roomCode,user:e.props.currentUser}),e.setState(Object(F.a)(Object(F.a)({},e.state),{},{focus:!e.state.focus}))},children:this.state.focus?"View all":"View yours"})})]})})}),Object(p.jsxs)(M.a,{item:!0,xs:10,children:[!this.props.host&&this.props.shareWhiteboards.map(V(this)),V(this)({user:this.props.currentUser}),this.props.host&&!this.state.focus&&this.props.content.map(V(this))]})]})}}]),r}(o.a.Component),G=r(201),Y=r(202),X=Object(u.a)((function(e){return{icon:{color:"#ff5138",marginRight:e.spacing(2)},root:{flexGrow:1,marginBottom:e.spacing(1)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),H=function(){var e=Object(l.f)(),t=X();return Object(p.jsx)("div",{className:t.root,children:Object(p.jsx)(G.a,{position:"relative",style:{backgroundColor:"#f3f5f8"},elevation:1,children:Object(p.jsx)(Y.a,{children:Object(p.jsx)("img",{src:I,style:{maxWidth:50},className:"img",onClick:function(){window.confirm("Do you want to go home?")&&e.push("/")}})})})})},K=function(e){var t=e.host,r=e.roomCode,o=e.content,s=e.currentUser,a=Object(n.useState)([]),c=Object(i.a)(a,2),u=c[0],d=c[1];j.on("share-whiteboard",(function(e){-1===u.findIndex((function(t){return t.roomCode===e.roomCode&&t.user.userID===e.user.userID}))&&e.roomCode===r&&e.user.userID!==s.userID&&d([].concat(Object(E.a)(u),[e]))})),j.on("stop-share",(function(e){if(-1!==u.findIndex((function(t){return t.roomCode===e.roomCode&&t.user.userID===e.user.userID}))&&e.userID!==s.username){var t=u.filter((function(t){return t.roomCode!==e.roomCode||t.username!==e.username}));d(t)}}));var l=o.filter((function(e){return e.userID!==s.userID})).map((function(e){return{user:{userID:e.userID,username:e.username}}}));return Object(p.jsxs)(M.a,{container:!0,spacing:2,children:[Object(p.jsx)(M.a,{item:!0,xs:12,children:Object(p.jsx)(H,{})}),Object(p.jsx)(M.a,{item:!0,xs:1}),Object(p.jsx)(M.a,{item:!0,xs:11,children:Object(p.jsxs)(C.a,{variant:"h3",children:["Room ",r]})}),Object(p.jsx)(M.a,{item:!0,xs:12,children:Object(p.jsx)(_,{host:t,roomCode:r,currentUser:s,shareWhiteboards:u,content:l})})]})},Q=function(){var e=window.location.href.split("/").slice(-1)[0],t=Object(n.useState)(1),r=Object(i.a)(t,2),o=r[0],s=r[1],a=Object(n.useState)({users:[]}),c=Object(i.a)(a,2),u=c[0],d=c[1],h=Object(n.useState)(!1),m=Object(i.a)(h,2),b=m[0],f=m[1],g=Object(l.g)(),x=g.state.host,O=g.state.user,v=Object(l.f)();return window.onbeforeunload=function(){j.emit("leave",O)},Object(n.useEffect)((function(){j.connect(),j.emit("userJoinedRoom",{roomCode:e,user:O},(function(e){var t=e.started;f(t)})),j.on("update_user",(function(e){console.log(e),s(e.users.length),d(e.users),0!==O.username.length&&-1===e.users.findIndex((function(e){return e.userID===O.userID}))&&(v.push("/"),alert("Sorry, you have been removed by the host"))})),j.on("update_session_start",(function(e){f(e.start)}))}),[]),console.log("content in room page",u),b?Object(p.jsx)(K,{host:x,roomCode:e,content:u,currentUser:O}):Object(p.jsx)(R,{host:x,roomCode:e,users:o,content:u,currentUser:O})},Z=r(54),$=Object(u.a)((function(e){return{container:{justifyItems:"center"}}}));var ee=function(){return $(),Object(p.jsx)(Z.a,{children:Object(p.jsxs)(l.c,{children:[Object(p.jsx)(l.a,{exact:!0,path:"/",children:Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(D,{})})}),Object(p.jsx)(l.a,{path:"/room/:roomCode",children:Object(p.jsx)(Q,{})})]})})};a.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(ee,{})}),document.getElementById("root"))},80:function(e,t,r){}},[[159,1,2]]]);
//# sourceMappingURL=main.b18c31c7.chunk.js.map